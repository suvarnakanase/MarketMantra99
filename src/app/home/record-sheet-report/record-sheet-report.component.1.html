<button mat-raised-button (click)='exportToExcel(dataSource)' *ngIf='dataSource.length !==0'>EXPORT </button>

<div fxLayout="row" fxLayoutAlign="center center" *ngIf='showLoader' style='margin:75px 0px'>
    <mat-spinner></mat-spinner>
</div>

<div> 
<div class="mat-elevation-z1   divTable">
    <table class="" *ngIf='dataSource.length !==0'>
        <thead>
            <ng-container *ngFor="let column of displayedColumns; index as j">
                <th>{{column}}</th>
            </ng-container>
        </thead>

        <tbody>
            <ng-container *ngFor="let item of dataSource; index as i">
                <tr>
                    <ng-container *ngFor="let p of getProperties(item); index as m">
                        <td [ngClass] ="m==0? 'firstTd': ''" [ngClass]="item[p] && item[p].includes('HIGH')  ? 'green': 
                                                     item[p] && item[p].includes('LOW')  ? 'red': '' ">{{item[p]}}</td>
                    </ng-container>
                </tr>
            </ng-container>
        </tbody>
    </table>
</div>